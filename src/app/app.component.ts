import { Component } from '@angular/core';
import { theme } from '../assets/map_theme';
import { environment } from '../environments/environment';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})

export class AppComponent {
	//Initial lat/lng for the map
	//TODO: Get user location
	lat: number = 42;
	lng: number = -84;
	mapImageUrl: string = '../assets/mapdot.png'
	locationIcon: string = '../assets/mapdotpurple.png'
	theme = theme;
	showInfoWindow: Boolean = false;
	markers = [];

	//List of malware
	//Includes URL, description, etc
	malware = {};
	categoryKeys = () => { return Object.keys(this.malware) }
	malwareKeys = (category) => { return Object.keys(this.malware[category]) }
	toggleInfo = () => { this.showInfoWindow = !this.showInfoWindow };

	//When we initialize the component, get the data from server
	ngOnInit() {
		//Get the malware list
		fetch(environment.api_url + '/api/rawdata').then(response => {
			if (response.ok) {
				response.json().then(json => {
					console.log(json)
					this.malware = json;
				});
			}
		});
	}
}