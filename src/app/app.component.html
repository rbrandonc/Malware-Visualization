<!-- Map -->
<agm-map id='map'
  [latitude]='lat' 
  [longitude]='lng'
  [styles]='theme'
  [disableDefaultUI]='true'
  [streetViewControl]='false'
  [zoomControl]='false'
  [zoom]='3'>

<!-- User Location Marker -->
  <agm-marker [latitude]='lat' [longitude]='lng' [iconUrl]='locationIcon'></agm-marker>

  <!-- Malware Locations -->
  <ng-container *ngFor='let cat of categoryKeys()'>
    <agm-marker *ngFor='let mal of malwareKeys(cat)'
      [latitude]='malware[cat][mal].lat'
      [longitude]='malware[cat][mal].lng'
      [iconUrl]='mapImageUrl'
      [visible]='malware[cat][mal].visible'>
    </agm-marker>
  </ng-container>
</agm-map>


<!-- Information Pane -->
<div id='infoContainer' class='columns'>
  <div class='column spacer'></div>  
  <div class='column is-1 fade'></div>

<!-- Display Toggle -->
  <div *ngIf='showInfoWindow' class='arrow column is-1 dark' 
    (click)='toggleInfo()'><span>▶</span></div>

  <div *ngIf='!showInfoWindow' class='arrow column is-1 dark'
    (click)='toggleInfo()'><span>◀</span></div>

<!-- Actual Info Pane -->
  <div id='info' class='column is-3 dark' *ngIf='showInfoWindow'>
    
    <div id='stats' class='columns'>
      <div class=column is-12>
         <canvas baseChart
          [data]="malwareCounts()"
          [labels]="categoryKeys()"
          chartType="polarArea">
          </canvas>
          <!-- (chartHover)="chartHovered($event)"
          (chartClick)="chartClicked($event)" -->
      </div>
    </div>

    <div id='malwareList' class='columns'>
      <div class='column is-12'>
        <ng-container *ngFor='let key of categoryKeys()'>
        <category *ngIf='malwareKeys(key).length > 0'
          [title]='key'
          [(malware)]='malware[key]'
          [collapsed]='false'
          [visible]='true'>
        </category>
      </ng-container>
      </div>
    </div>

  </div>
</div>
