// import { TestBed, async } from '@angular/core/testing';
const axioss = require('axios');
describe("Server", () => {
    var server;
    var startServer = () => {
        server = require("./server");
    };
    var killServer = (done) => {
        server.close(done);
    };
    var GET = (done, endpoint, callback) => {
        axioss.get("http://localhost:3000/" + endpoint)
            .then((response) => {
            // console.log(response)
            callback(response);
            done();
        });
    };
    describe("GET /", () => {
        var data = {};
        startServer();
        it("Status 200", (done) => {
            GET((done), '', (response) => {
                expect(response.status).toBe(200);
            });
        });
        it("Body", (done) => {
            GET(done, '', (response) => {
                // console.log(response)
                expect(response.data).toMatch("<!doctype html>");
            });
        });
    });
    describe("GET /api", () => {
        var data = {};
        startServer();
        it("Status 200", (done) => {
            GET((done), 'api', (response) => {
                expect(response.status).toBe(200);
            });
        });
        it("Body", (done) => {
            GET(done, 'api', (response) => {
                // console.log(response)
                expect(response.data).toBe("API Alive");
                // killServer(done);
            });
        });
    });
    describe("GET /api/rawdata", () => {
        var data = {};
        startServer();
        it("Status 200", (done) => {
            GET((done), 'api/rawdata', (response) => {
                expect(response.status).toBe(200);
            });
        });
        it("Data", (done) => {
            GET(done, 'api/rawdata', (response) => {
                // console.log(Object.keys(response.data))
                expect(Object.keys(response.data)).toEqual(['phishing', 'exploit', 'trojan', 'other']);
                killServer(done);
            });
        });
    });
});
